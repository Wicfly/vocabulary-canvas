# 📸 拍照转 3D 功能说明

## 功能概述

现在您的应用支持通过拍照将现实世界中的物体转换为 3D 模型，并显示在画布上。这个功能使用了 Meta 的 SAM 3D 技术。

## 已实现的功能

### ✅ 1. 拍照按钮
- 在搜索框旁边添加了圆形拍照按钮
- 黑色背景，白色相机图标
- 点击后打开摄像头界面

### ✅ 2. 摄像头拍照功能
- 支持访问设备摄像头
- 可以预览和确认照片
- 支持重拍功能
- 自动使用后置摄像头（移动设备）

### ✅ 3. 3D 模型转换
- 调用 SAM 3D API 将照片转换为 3D 模型
- 支持多种 API 配置方式（自定义后端、Hugging Face、Replicate）
- 自动识别物体名称
- 获取单词定义

### ✅ 4. 3D 模型显示
- 在画布上以 3D 形式显示物体
- 支持自动旋转
- 支持鼠标拖拽旋转查看
- 支持在画布上拖拽移动位置

### ✅ 5. 悬浮提示
- 鼠标悬浮在 3D 模型上显示物体名称
- 显示英文单词解释
- 提供删除按钮

## 文件结构

### 新增文件

1. **`src/components/CameraModal.jsx`**
   - 摄像头拍照模态框组件
   - 处理摄像头访问和拍照确认

2. **`src/components/Object3D.jsx`**
   - 3D 模型渲染组件
   - 使用 Three.js 渲染 3D 模型
   - 支持交互控制

3. **`src/utils/sam3d.js`**
   - SAM 3D API 调用工具
   - 支持多种 API 配置方式

### 修改的文件

1. **`src/components/WordInput.jsx`**
   - 添加了拍照按钮
   - 集成了 CameraModal 组件

2. **`src/components/WordSticker.jsx`**
   - 支持显示 3D 模型
   - 自动识别并渲染 3D 或普通图片

3. **`src/App.jsx`**
   - 添加了处理 3D 模型的逻辑
   - 集成 SAM 3D API 调用

## 配置要求

### 必需配置

您需要在 `.env` 文件中配置 SAM 3D API。有三种选择：

#### 选项 1：自定义后端 API
```env
VITE_SAM3D_API_URL=https://your-backend-url.com/api/sam3d
```

#### 选项 2：Hugging Face API
```env
VITE_HF_API_TOKEN=your_huggingface_token
VITE_HF_SAM3D_MODEL_ID=facebook/sam-3d
```

#### 选项 3：Replicate API
```env
VITE_REPLICATE_API_TOKEN=your_replicate_token
```

详细配置说明请查看 `SAM3D_SETUP.md`

## 使用流程

1. **点击拍照按钮**
   - 在搜索框右侧找到圆形黑色相机图标按钮
   - 点击打开摄像头

2. **拍照**
   - 授予浏览器摄像头权限
   - 对准要拍摄的物体
   - 点击"拍照"按钮
   - 预览照片，可以"重拍"或"确认"

3. **等待处理**
   - 系统自动调用 SAM 3D API 转换图像
   - 识别物体名称
   - 获取单词定义
   - 在画布上显示 3D 模型

4. **交互**
   - 鼠标悬浮查看物体名称和定义
   - 拖拽 3D 模型在画布上移动
   - 点击并拖拽旋转 3D 模型查看不同角度
   - 点击删除按钮移除模型

## 技术栈

- **Three.js**: 3D 渲染引擎
- **@react-three/fiber**: React 的 Three.js 渲染器
- **@react-three/drei**: Three.js 辅助工具库
- **Meta SAM 3D**: 图像到 3D 模型转换

## 注意事项

1. **浏览器兼容性**
   - 需要支持 `getUserMedia` API 的现代浏览器
   - 建议使用 HTTPS 连接（某些浏览器要求）

2. **性能考虑**
   - 3D 模型文件应该尽量小（建议 < 5MB）
   - 使用 GLB 格式可以减小文件大小
   - 多个 3D 模型可能影响性能

3. **存储限制**
   - 3D 模型数据存储在 localStorage 中
   - 大量 3D 模型可能超出 localStorage 限制
   - 考虑使用 IndexedDB 存储大型数据

4. **API 配置**
   - 如果没有配置 SAM 3D API，拍照功能会报错
   - 确保 API 端点配置正确
   - 检查 API 密钥是否有效

## 故障排除

### 摄像头无法访问
- 检查浏览器权限设置
- 确保使用 HTTPS 连接
- 尝试刷新页面重新请求权限

### 3D 模型不显示
- 检查浏览器控制台错误信息
- 验证 API 返回的模型格式
- 确认模型 URL 可访问
- 检查 Three.js 库是否正确加载

### API 调用失败
- 检查网络连接
- 验证 API 端点配置
- 查看 API 密钥是否有效
- 检查 API 响应格式是否正确

## 下一步改进建议

1. 添加加载进度指示
2. 支持批量拍照和转换
3. 优化 3D 模型加载性能
4. 添加模型缩放功能
5. 支持导出 3D 模型
6. 添加模型库功能

## 相关文档

- `SAM3D_SETUP.md` - 详细的 API 配置指南
- `README.md` - 项目总体说明


